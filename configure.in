# Process this file with autoconf to produce a configure script.C
AC_INIT(rts2, 0.2.2, petr@lascaux.asu.cas.cz)

AM_INIT_AUTOMAKE(rts2, 0.2.2)

AC_CONFIG_SRCDIR(src)
AM_CONFIG_HEADER(config.h)

AM_MAINTAINER_MODE

# Checks for programs.
AC_PROG_CC
AC_PROG_MAKE_SET

# Checks for libraries.
# FIXME: Replace `main' with a function in `-lm':
AC_CHECK_LIB([m], [sqrt], LIB_M="-lm"; LIBS="-lm $LIBS";
AC_SUBST(LIB_M), [cat << EOF
**** You don't have math library.
**** Please install one and make sure, that -lm switch
**** works as expected.
EOF
exit 1])
# FIXME: Replace `main' with a function in `-lcfitsio':
AC_CHECK_LIB([cfitsio], [main], , [cat <<EOF
**** You don't have cfitsio installed.
**** Please grab it from http://????.gsfc.nasa.gov
EOF
exit 1])
# FIXME: Replace `main' with a function in `-lncurses':
AC_CHECK_LIB([ncurses], [main])
# FIXME: Replace `main' with a function in `-lnova':
AC_CHECK_LIB([nova], [get_ln_version])
# FIXME: Replace `main' with a function in `-lpthread':
AC_CHECK_LIB([pthread], [pthread_exit], LIB_PTHREAD="-lpthread";
LIBS="-lpthread $LIBS"; AC_SUBST(LIB_PTHREAD))

#debug="-DDEBUG"
debug=""
AC_SUBST(debug)

# Checks for header files.
AC_HEADER_STDC
AC_HEADER_SYS_WAIT
AC_CHECK_HEADERS([argz.h arpa/inet.h fcntl.h malloc.h netdb.h netinet/in.h stdlib.h string.h sys/ioctl.h sys/socket.h sys/time.h syslog.h termios.h unistd.h])

# Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_TYPE_PID_T
AC_TYPE_SIZE_T
AC_HEADER_TIME
AC_STRUCT_TM

# Check for PostgreSQL
AC_POSTGRESQL
AC_ECPG

# Checks for library functions.
AC_FUNC_FORK
AC_PROG_GCC_TRADITIONAL
AC_FUNC_MALLOC
AC_FUNC_MKTIME
AC_TYPE_SIGNAL
AC_FUNC_STRTOD
AC_CHECK_FUNCS([atexit dup2 floor gethostbyname gettimeofday inet_ntoa memmove memset select socket strchr strdup strerror strtol])

AC_OUTPUT([Makefile
	   doc/Makefile
	   doc/dia/Makefile
	   src/Makefile
	   src/camd/Makefile
	   src/db/Makefile
	   src/grb/Makefile
	   src/grb/bacodine/Makefile
	   src/grb/ibas/Makefile
	   src/monitor/Makefile
	   src/plan/Makefile
	   src/plan/pgsql/Makefile
	   src/serverd/Makefile
	   src/teld/Makefile
	   src/utils/Makefile
	   src/writers/Makefile])
#                 doc/Makefile
#                 doc/dia/Makefile
#                 doc/doxygen/latex/Makefile
#                 doc/prezentace/Makefile
#                 src/camc/Makefile
#                 src/camd/Makefile
#                 src/camd/apogee/Makefile
#                 src/camd/sbig/Makefile
#                 src/camd/urvc/Makefile
#                 src/images_util/Makefile
#                 src/teld/Makefile
#                 src/teld/lx200/Makefile
