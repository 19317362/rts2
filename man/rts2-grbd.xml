<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd" [

  <!ENTITY dhfirstname "<firstname>Petr</firstname>">
  <!ENTITY dhsurname   "<surname>Kubanek</surname>">
  <!ENTITY dhdate      "<date>2008-02-16</date>">
  <!ENTITY dhsection   "<manvolnum>1</manvolnum>">
  <!ENTITY dhemail     "<email>petr@kubanek.net</email>">
  <!ENTITY dhusername  "Petr Kubanek">
  <!ENTITY dhpackage   "rts2-grbd">

  <!ENTITY % rts2 SYSTEM "rts2.ent">
  %rts2;
]>

<refentry>
  <refentryinfo>
    <title>&dhpackage;</title>
    <productname>rts2</productname>
    <productnumber>&rts2version;</productnumber>
    &dhdate;
    <authorgroup>
      <author>
        &dhfirstname;
        &dhsurname;
	<contrib>Wrote most of the RTS2 package.</contrib>
	<address>
          &dhemail;
	</address>
      </author>
    </authorgroup>
    <copyright>
      <year>2008</year>
      <holder>&dhusername;</holder>
    </copyright>
    &legal;
  </refentryinfo>
  <refmeta>
    <refentrytitle>&dhpackage;</refentrytitle>
    &dhsection;
  </refmeta>
  <refnamediv>
    <refname>&dhpackage;</refname>
    <refpurpose>Receives GCNs allerts, create their targets in the database and executes arbitary script upon their arrival.</refpurpose>
  </refnamediv>
  <refsynopsisdiv>
    <cmdsynopsis>
      <command>&dhpackage;</command>
      &dbapp;
      <arg choice="opt"><option>-i</option></arg>
      <arg choice="opt"><option>--local-port <replaceable>port number</replaceable></option></arg>
      <arg choice="opt"><option>--localhost <replaceable>hostname</replaceable></option></arg>
      <arg choice="opt"><option>--modefile <replaceable>filename</replaceable></option></arg>
      <arg choice="opt"><option>-d <replaceable>device name</replaceable></option></arg>
      <arg choice="opt"><option>--gcn_host</option></arg>
      <arg choice="opt"><option>--gcn_port</option></arg>
      <arg choice="opt"><option>--test</option></arg>
      <arg choice="opt"><option>--forward <replaceable>port</replaceable></option></arg>
      <arg choice="opt"><option>--add-exec <replaceable>command</replaceable></option></arg>
      <arg choice="opt"><option>--exec_followups</option></arg>
      <arg choice="opt"><option>--queue-to <replaceable>queue name</replaceable></option></arg>
    </cmdsynopsis>

  </refsynopsisdiv>

  <refsect1 id="description">
    <title>DESCRIPTION</title>

    <para>
      <command>&dhpackage;</command> receives informations from GCN. Enables executing of a command
      when new GCN message arrive. It can also retransmit GCN packets to behind-firewall hosts.
    </para>

  </refsect1>
  <refsect1 id="options">
    <title>OPTIONS</title>

    &optiongnu;

    <variablelist>
      &dbapplist;
      <varlistentry>
        <term><option>--queue-to <replaceable class="parameter">queue name</replaceable></option></term>
        <listitem>
          <para>
	    Queue GRB target to queue. If
	    <citerefentry><citerefentry>rts2-executor</citerefentry><manvolnum>1</manvolnum></citerefentry>
	    is running, it will still be notified about GRB via its
	    <emphasis>grb</emphasis> command. Then queue specified as argument
	    will be notified through <emphasis>now</emphasis> command.
	  </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>--server <replaceable class="parameter">server-name[:port]</replaceable></option></term>
        <listitem>
          <para>
	    Specify name of the host and possibly port, which runs
	    <citerefentry><refentrytitle>rts2-centrald</refentrytitle><manvolnum>1</manvolnum></citerefentry>.
	    This option is needed only for setups that use multiple computers.
	    Its default is localhost for hostname and 617 for port number. If
	    only hostname is provided, default port number - 617 - is used. 
	    Default will work for simple setups.
	  </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>--test</option></term>
        <listitem>
          <para>If set, GCN test routines will be processed, writen to database and executed.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><option>--add-exec <replaceable class="parameter">command</replaceable></option></term>
        <listitem>
          <para>
	    Specify command which will be executed once the GCN notice with GRB
	    arrives. The command received as parameters following informations:
	    <variablelist>
	      <varlistentry>
	        <term>target_id</term>
		<listitem>
		  <para>
                    GRB target ID. That is RTS2 Target ID of the GRB being processed.
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_id</term>
		<listitem>
		  <para>
		    GRB ID, assigned by GCN. Should be unique with some cautions. It is better base GRB processing on
		    RTS2 target ID, as that is more unique - e.g. if Swift starts follow-ups of Integral GRB, grb id of that
		    follow-up observations is different from Integral ID.
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_seqn</term>
		<listitem>
		  <para>
		    GRB sequential number. Used in old BATSE days, nowadays almost always 0 or 1.
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_type</term>
		<listitem>
		  <para>
		    GRB packet type. Please see
		    <ulink url="http://gcn.gsfc.nasa.gov/sock_pkt_def_doc.html"><citetitle>GCN website</citetitle></ulink> for
		    complete list of type ids.
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_ra</term>
		<listitem>
		  <para>
		    GRB RA specified in decimal degrees (e.g. expect 0..360 range).
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_dec</term>
		<listitem>
		  <para>
		    GRB DEC specified in decimal degrees (-90..90 range).
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_date</term>
		<listitem>
		  <para>
                    GRB date as ctime (sec since 1-1-1970).
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_errorbox</term>
		<listitem>
		  <para>
		    GRB errobox size in decimal degrees, usually expect some small number (way bellow 1 degree).
		  </para>
		</listitem>
	      </varlistentry>
	      <varlistentry>
	        <term>grb_isnew</term>
		<listitem>
		  <para>
		    1 if this is new GRB, 0 if this message is update of an already know GRB.
		  </para>
		</listitem>
	      </varlistentry>
	    </variablelist>
	  </para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>
  <refsect1>
    <title>SEE ALSO</title>

    <para>
      <citerefentry>
        <refentrytitle>rts2</refentrytitle>
	<manvolnum>7</manvolnum>
      </citerefentry>
      <citerefentry>
        <refentrytitle>rts2.ini</refentrytitle>
	<manvolnum>5</manvolnum>
      </citerefentry>
    </para>

  </refsect1>
</refentry>
