\chapter{Databáze}

Pøesnou strukturu databáze - zvlá¹tì pak datové typy jednotlivých polo¾ek - je
mo¾né nalézt v SQL skriptech, slou¾ících pro vytvoøení databáze, které jsou v
adresáøi sql.

V následujícím textu jsou primární klíèe znaèeny znaèkou $\star$. Indexované
pole jsou pak znaèeny pomocí $\ast$.

\subsubsection{Tabulka epoch}

\begin{tabular}{ll}
{\bf $\star$ epoch\_id}	& identifikace epochy \\
{\bf epoch\_start}	& zaèátek epochy \\
{\bf epoch\_end}	& konec epochy
\end{tabular}

\subsubsection{Tabulka targets}

\begin{tabular}{ll}
{\bf $\star$ tar\_id}	& èíslo cíle \\
{\bf type\_id}		& typ pozorování \\
{\bf tar\_name}		& jméno cíle \\
{\bf tar\_ra}		& rektascenze cíle \\
{\bf tar\_dec}		& deklinace cíle \\
{\bf tar\_comment}	& komentáø \\
\end{tabular}

\subsubsection{Tabulka types}

\begin{tabular}{ll}
{\bf $\star$ type\_id}	& èíslo typu \\
{\bf type\_description}	& popis
\end{tabular}

\subsubsection{Tabulka observations}

\begin{tabular}{ll}
{\bf $\ast$ tar\_id}	& èíslo cíle \\
{\bf $\star$ obs\_id}	& èíslo pozorování \\
{\bf $\ast$ obs\_start}	& datum zahájení pozorování \\
{\bf obs\_duration}	& délka trvání pozorování \\
\end{tabular}

\subsubsection{Tabulka images}

\begin{tabular}{ll}
{\bf $\star$ img\_id}	& èíslo snímku \\
{\bf img\_name}		& jméno snímku \\
{\bf $\ast$ img\_date}	& datum poøízení snímku \\
{\bf img\_exposure}	& délka expozice \\
{\bf img\_temperature}	& teplota CCD èipu \\
{\bf img\_filter}	& pou¾itý filtr \\
{\bf astrometry}	& pozice snímku \\
{\bf $\ast$ obs\_id}	& èíslo pozorování \\
{\bf camera\_name}	& jméno kamery \\
{\bf mount\_name}	& jméno montá¾e \\
{\bf epoch\_id}		& èíslo epochy \\
{\bf media\_id}		& médium, na kterém je snímek umístìn
\end{tabular}

\subsubsection{Tabulka darks, flats}

\begin{tabular}{ll}
{\bf dark\_name}	& jméno snímku \\
{\bf $\ast$ dark\_date}	& datum poøízení snímku \\
{\bf dark\_exposure}	& délka expozice \\
{\bf dark\_temperature}	& teplota CCD èipu \\
{\bf camera\_name}	& jméno kamery
\end{tabular}

\vspace{1cm}

Tabulka flats obsahuje stejná pole, pouze jejich prefix je flat.

\subsubsection{Tabulka cameras}

\begin{tabular}{ll}
{\bf $\star$ camera\_name}	& jméno kamery \\
{\bf camera\_desc}		& popis kamery
\end{tabular}

\subsubsection{Tabulka mounts}

\begin{tabular}{ll}
{\bf $\star$ mount\_name}	& jméno montá¾e \\
{\bf mount\_long}		& zemìpisná délka montá¾e \\
{\bf mount\_lat}		& zemìpisná ¹íøka montá¾e \\
{\bf mount\_alt}		& nadmoøská vý¹ka montá¾e \\
{\bf mount\_desc}		& popis montá¾e
\end{tabular}

\subsubsection{Tabulka grb}

\begin{tabular}{ll}
{\bf tar\_id}		& èíslo pozorování \\
{\bf $\star$ grb\_id}	& èíslo GRB \\
{\bf grb\_seqn}		& aktuální èíslo poøadí zprávy \\
{\bf grb\_date}		& datum pozorování GRB \\
{\bf grb\_last\_update}	& datum poslední zmìny stavu GRB \\
\end{tabular}

\subsubsection{Tabulka ot}

\begin{tabular}{ll}
{\bf tar\_id}		& èíslo pozorování \\
{\bf ot\_imgcount}	& poèet snímkù po¾adovaných za jednu noc \\
{\bf ot\_minpause}	& minimální rozestup mezi snímky \\
{\bf ot\_priority}	& priorita pozorování \\
\end{tabular}

\subsubsection{Tabulka medias}

\begin{tabular}{ll}
{\bf $\star$med\_id}	& identifikaèní èíslo média \\
{\bf med\_path}		& cesta, na které je médium namontováno \\
{\bf med\_mounted}	& logická hodnota, urèující, jestli je dané médium namontováno
\end{tabular}

\vspace{1cm}

V databázi je definován u¾ivatelský typ, který slou¾í pro ukládání informace o
poloze snímku. Je odvozen ze struktury, pou¾ívané v knihovnì libwcs. Obsahuje
informace o poloze referenèního bodu snímku, jeho souøadnicích, rozmìrech
pixelu, rotaci snímku a parametry korekèního polynomu, který slou¾í pro
výpoèet souøadnic ostatních bodù na snímku.

V databázi jsou dále implementovány funkce, slou¾ící jednak k obsluze
u¾ivatelského typu pro ukládání souøadnic snímku, a jednak k transformacím
ekliptikálních souøadnic na horizontální, a výpoèet vzdu¹né hmoty.
